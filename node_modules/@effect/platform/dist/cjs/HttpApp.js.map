{"version":3,"file":"HttpApp.js","names":["Context","_interopRequireWildcard","require","Effect","Exit","FiberRef","Layer","Runtime","Scope","_Unify","ServerError","ServerRequest","ServerResponse","internal","internalMiddleware","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","handledSymbol","Symbol","for","toHandled","self","handleResponse","middleware","responded","withFiberRuntime","fiber","flatMap","response","request","unsafeGet","currentContext","HttpServerRequest","handler","getFiberRef","currentPreResponseHandlers","_tag","as","tap","value","withErrorHandling","catchAllCause","cause","causeResponse","zipRight","failCause","withMiddleware","unify","undefined","tracer","matchCauseEffect","onFailure","void","_cause","empty","status","onSuccess","uninterruptible","scoped","exports","appendPreResponseHandler","withPreResponseHandler","toWebHandlerRuntime","runtime","run","runFork","resolveSymbol","httpApp","toWeb","withoutBody","method","context","Promise","resolve","contextMap","Map","unsafeMap","httpServerRequest","fromWeb","key","locally","unsafeMake","signal","addEventListener","unsafeInterruptAsFork","clientAbortFiberId","once","toWebHandler","defaultRuntime","toWebHandlerLayer","layer","scope","runSync","make","close","runPromise","build","map","toRuntime","_","runner","extend","then"],"sources":["../../src/HttpApp.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}