{"version":3,"file":"HttpApiBuilder.js","names":["Cause","_interopRequireWildcard","require","Chunk","Context","Effect","Encoding","Fiber","_Function","_GlobalValue","Layer","ManagedRuntime","Option","ParseResult","_Pipeable","Redacted","Schema","_Unify","HttpApi","_HttpApiError","HttpApiMiddleware","HttpApiSchema","HttpApp","HttpMethod","HttpMiddleware","HttpRouter","HttpServer","HttpServerRequest","HttpServerResponse","OpenApi","UrlParams","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","Router","Tag","exports","api","effect","Api","map","context","serve","middleware","httpApp","pipe","app","unwrapEffect","provide","Live","Middleware","layer","gen","makeMiddlewareMap","middlewares","router","applyMiddleware","apiMiddlewareService","apiMiddleware","retrieve","errorSchema","makeErrorSchema","encodeError","encodeUnknown","catchAllCause","cause","matchEffect","squash","onFailure","failCause","onSuccess","succeed","toWebHandler","options","runtime","make","mergeAll","memoMap","handlerCached","handlerPromise","rt","runtimeEffect","handler","toWebHandlerRuntime","runPromise","request","undefined","then","dispose","HandlersTypeId","Symbol","for","HandlersProto","_Endpoints","identity","pipeArguments","arguments","handle","name","endpoint","group","endpoints","makeHandlers","handlers","append","withFullResponse","handleRaw","self","create","groupName","build","use","groups","result","empty","isEffect","groupMiddleware","routes","item","push","handlerToRoute","mapInputContext","input","merge","concat","fromIterable","_api","_groupName","_name","f","requestPayload","urlParams","hasBody","method","contentType","headers","toLowerCase","trim","includes","orDie","json","multipart","urlParamsBody","toRecord","startsWith","text","arrayBuffer","buffer","Uint8Array","initial","Map","forEach","tag","key","unsafeGet","endpoint_","isFullResponse","decodePath","pathSchema","decodeUnknown","decodePayload","payloadSchema","decodeHeaders","headersSchema","decodeUrlParams","urlParamsSchema","encodeSuccess","encode","makeSuccessSchema","successSchema","makeRoute","path","fiber","getOrThrow","getCurrentFiber","currentContext","httpRequest","routeContext","RouteContext","ParsedSearchParams","_tag","value","params","payload","flatMap","response","catchIf","isParseError","HttpApiDecodeError","refailParseError","entry","values","SecurityTypeId","makeSecurityMiddleware","optional","previous","provides","provideService","_","provideServiceEffect","zipRight","securityMiddlewareCache","globalValue","security","entries","decode","securityDecode","catchAll","void","responseSchema","declare","isServerResponse","schema","schemas","Set","deunionize","Union","Array","from","toResponseSuccess","toResponseError","decodeForbidden","__","ast","fail","Forbidden","toResponseSchema","getStatus","cache","schemaToResponse","data","isEmpty","isVoid","to","status","encoding","getEncoding","kind","mapError","error","Type","uint8Array","transform","transformOrFail","getStatusSuccessAST","getStatusErrorAST","sync","of","add","prev","middlewareAdd","service","middlewareAddNoContext","args","apiFirst","isHttpApi","withContext","effectDiscard","middlewareScoped","scopedDiscard","middlewareCors","cors","middlewareOpenApi","spec","fromApi","bearerLen","length","basicLen","authorization","slice","Struct","String","unify","in","schemaSearchParams","schemaCookies","schemaHeaders","match","username","password","decodeBase64String","header","parts","split","securitySetCookie","stringValue","appendPreResponseHandler","_req","setCookie","secure","httpOnly"],"sources":["../../src/HttpApiBuilder.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}