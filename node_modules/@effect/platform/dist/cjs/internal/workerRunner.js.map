{"version":3,"file":"workerRunner.js","names":["Cause","_interopRequireWildcard","require","Chunk","Context","Effect","Either","Fiber","_Function","Layer","Schedule","Schema","Stream","Transferable","_WorkerError","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","PlatformRunnerTypeId","exports","Symbol","for","PlatformRunner","GenericTag","run","process","options","gen","platform","backing","start","fiberMap","Map","portId","id","kind","data","span","fiber","void","interrupt","withFiberRuntime","decode","succeed","pipe","flatMap","input","collector","unsafeMakeCollector","stream","effect","isEffect","out","encodeOutput","provideService","Collector","payload","send","unsafeRead","runForEachChunk","chunk","undefined","toReadonlyArray","unsafeClear","forEach","andThen","withParentSpan","_tag","traceId","spanId","sampled","context","empty","uninterruptibleMask","restore","catchIf","isWorkerError","error","WorkerError","encodeCause","fail","catchAllCause","cause","match","failureOrCause","onLeft","encodeError","onRight","ensuring","sync","delete","make","tapErrorCause","isInterruptedOnly","logWarning","retry","spaced","annotateLogs","package","module","interruptAsFork","interruptible","forkScoped","asVoid","layer","scopedDiscard","makeSerialized","schema","handlers","_","scope","parseRequest","decodeUnknown","request","result","isLayer","buildWithScope","merge","provide","provideContext","message","mapError","reason","serializeFailure","serializeSuccess","layerSerialized"],"sources":["../../../src/internal/workerRunner.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}