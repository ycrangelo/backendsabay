{"version":3,"file":"keyValueStore.js","names":["Context","Effect","Either","Encoding","dual","identity","pipe","Layer","Option","Schema","PlatformError","FileSystem","Path","TypeId","Symbol","for","keyValueStoreTag","GenericTag","make","impl","of","has","key","map","get","isSome","isEmpty","size","modify","f","flatMap","o","isNone","succeedNone","newValue","value","as","set","some","modifyUint8Array","getUint8Array","forSchema","schema","makeSchemaStore","makeStringOnly","encoder","TextEncoder","match","decodeBase64","onLeft","encode","onRight","suspend","encodeBase64","prefix","self","remove","SchemaStoreTypeId","store","jsonSchema","parseJson","parse","decodeUnknown","onNone","onSome","asSome","json","clear","layerMemory","sync","Map","fromNullable","delete","layerFileSystem","directory","effect","gen","_","fs","path","keyPath","join","encodeURIComponent","exists","makeDirectory","recursive","readFileString","catchTag","sysError","reason","succeed","none","fail","readFile","writeFileString","writeFile","zipRight","readDirectory","files","length","layerSchema","tagIdentifier","tag","layer","storageError","props","SystemError","module","layerStorage","evaluate","storage","try","getItem","catch","pathOrDescriptor","method","message","setItem","removeItem"],"sources":["../../../src/internal/keyValueStore.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}